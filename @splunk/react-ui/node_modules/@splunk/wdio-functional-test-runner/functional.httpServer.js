'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _fixtureCompilation = require('./fixtureCompilation');

var _runnerUtils = require('./runnerUtils');

exports.default = function (config) {
    config.services = config.services || [];

    config.services.push('static-server');
    config.staticServerFolders = [{ mount: '/', path: (0, _fixtureCompilation.fixtureOutputPath)(config.suiOutputPath) }];
    config.staticServerPort = 49221;

    if (process.env.DOCKER_TCP_BIND_49221) {
        config.baseUrl = 'http://' + process.env.DOCKER_TCP_BIND_49221;
    } else {
        config.baseUrl = 'http://' + (0, _runnerUtils.guessNonInternalAddress)() + ':49221';
    }

    return config;

    // about the static server port: only a certain list of ports works if we use sauce, see here:
    //  https://wiki.saucelabs.com/display/DOCS/Sauce+Connect+Proxy+FAQS
    // a workaround would be to use something like myserver.local in the hosts file, but that's
    // not ideal for dev machines
};